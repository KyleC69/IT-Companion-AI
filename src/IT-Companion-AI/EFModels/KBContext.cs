// <auto-generated> This file has been auto generated by EF Core Power Tools. </auto-generated>
#nullable disable
using System;
using System.Collections.Generic;
using Microsoft.EntityFrameworkCore;

namespace ITCompanionAI;

public partial class KBContext : DbContext
{
    public KBContext() : base()
    {
    }

    public virtual DbSet<ApiFeature> ApiFeatures { get; set; }

    public virtual DbSet<ApiMember> ApiMembers { get; set; }

    public virtual DbSet<ApiMemberDiff> ApiMemberDiffs { get; set; }

    public virtual DbSet<ApiParameter> ApiParameters { get; set; }

    public virtual DbSet<ApiType> ApiTypes { get; set; }

    public virtual DbSet<ApiTypeDiff> ApiTypeDiffs { get; set; }

    public virtual DbSet<CodeBlock> CodeBlocks { get; set; }

    public virtual DbSet<DocPage> DocPages { get; set; }

    public virtual DbSet<DocPageDiff> DocPageDiffs { get; set; }

    public virtual DbSet<DocSection> DocSections { get; set; }

    public virtual DbSet<ExecutionResult> ExecutionResults { get; set; }

    public virtual DbSet<ExecutionRun> ExecutionRuns { get; set; }

    public virtual DbSet<FeatureDocLink> FeatureDocLinks { get; set; }

    public virtual DbSet<FeatureMemberLink> FeatureMemberLinks { get; set; }

    public virtual DbSet<FeatureTypeLink> FeatureTypeLinks { get; set; }

    public virtual DbSet<IngestionRun> IngestionRuns { get; set; }

    public virtual DbSet<RagChunk> RagChunks { get; set; }

    public virtual DbSet<RagRun> RagRuns { get; set; }

    public virtual DbSet<ReviewIssue> ReviewIssues { get; set; }

    public virtual DbSet<ReviewItem> ReviewItems { get; set; }

    public virtual DbSet<ReviewRun> ReviewRuns { get; set; }

    public virtual DbSet<Sample> Samples { get; set; }

    public virtual DbSet<SampleApiMemberLink> SampleApiMemberLinks { get; set; }

    public virtual DbSet<SampleRun> SampleRuns { get; set; }

    public virtual DbSet<SemanticIdentity> SemanticIdentities { get; set; }

    public virtual DbSet<SnapshotDiff> SnapshotDiffs { get; set; }

    public virtual DbSet<SourceSnapshot> SourceSnapshots { get; set; }

    public virtual DbSet<TruthRun> TruthRuns { get; set; }

    public virtual DbSet<VApiFeatureCurrent> VApiFeatureCurrents { get; set; }

    public virtual DbSet<VApiMemberCurrent> VApiMemberCurrents { get; set; }

    public virtual DbSet<VApiTypeCurrent> VApiTypeCurrents { get; set; }

    public virtual DbSet<VDocPageCurrent> VDocPageCurrents { get; set; }

    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
#warning To protect potentially sensitive information in your connection string, you should move it out of source code. You can avoid scaffolding the connection string by using the Name= syntax to read it from configuration - see https://go.microsoft.com/fwlink/?linkid=2131148. For more guidance on storing connection strings, see https://go.microsoft.com/fwlink/?LinkId=723263.
        => optionsBuilder.UseSqlServer("Data Source=localhost;Initial Catalog=KnowledgeBase;Integrated Security=True;Trust Server Certificate=True");

    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        modelBuilder.Entity<ApiFeature>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_api_feature");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_api_feature_id");
            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.IsActive).HasDefaultValue(true, "df_api_feature_is_active");
            entity.Property(e => e.SemanticUidHash)
                .HasComputedColumnSql("(CONVERT([binary](32),hashbytes('SHA2_256',[semantic_uid])))", true)
                .IsFixedLength();

            entity.HasOne(d => d.CreatedIngestionRun).WithMany(p => p.ApiFeatures)
                .OnDelete(DeleteBehavior.ClientSetNull)
                .HasConstraintName("fk_api_feature_created_ingestion_run");
        });

        modelBuilder.Entity<ApiMember>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_api_member");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_api_member_id");
            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.IsActive).HasDefaultValue(true, "df_api_member_is_active");
            entity.Property(e => e.MemberUidHash).IsFixedLength();
            entity.Property(e => e.SemanticUidHash)
                .HasComputedColumnSql("(CONVERT([binary](32),hashbytes('SHA2_256',[semantic_uid])))", true)
                .IsFixedLength();

            entity.HasOne(d => d.CreatedIngestionRun).WithMany(p => p.ApiMembers)
                .OnDelete(DeleteBehavior.ClientSetNull)
                .HasConstraintName("fk_api_member_created_ingestion_run");
        });

        modelBuilder.Entity<ApiMemberDiff>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_api_member_diff");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_api_member_diff_id");
        });

        modelBuilder.Entity<ApiParameter>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_api_parameter");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_api_parameter_id");
            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.IsActive).HasDefaultValue(true, "df_api_parameter_is_active");
            entity.Property(e => e.SemanticUidHash).IsFixedLength();

            entity.HasOne(d => d.CreatedIngestionRun).WithMany(p => p.ApiParameters)
                .OnDelete(DeleteBehavior.ClientSetNull)
                .HasConstraintName("fk_api_parameter_created_ingestion_run");
        });

        modelBuilder.Entity<ApiType>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_api_type");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_api_type_id");
            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.IsActive).HasDefaultValue(true, "df_api_type_is_active");
            entity.Property(e => e.SemanticUidHash)
                .HasComputedColumnSql("(CONVERT([binary](32),hashbytes('SHA2_256',[semantic_uid])))", true)
                .IsFixedLength();

            entity.HasOne(d => d.CreatedIngestionRun).WithMany(p => p.ApiTypes)
                .OnDelete(DeleteBehavior.ClientSetNull)
                .HasConstraintName("fk_api_type_created_ingestion_run");
        });

        modelBuilder.Entity<ApiTypeDiff>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_api_type_diff");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_api_type_diff_id");
        });

        modelBuilder.Entity<CodeBlock>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_code_block");

            entity.HasIndex(e => new { e.SemanticUid, e.VersionNumber }, "ix_code_block_semantic_version")
                .IsUnique()
                .HasFilter("([semantic_uid] IS NOT NULL)");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_code_block_id");
            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.IsActive).HasDefaultValue(true, "df_code_block_is_active");

            entity.HasOne(d => d.DocSection).WithMany(p => p.CodeBlocks)
                .OnDelete(DeleteBehavior.ClientSetNull)
                .HasConstraintName("fk_code_block_doc_section");

            entity.HasOne(d => d.RemovedIngestionRun).WithMany(p => p.CodeBlockRemovedIngestionRuns).HasConstraintName("fk_code_block_removed_ingestion_run");

            entity.HasOne(d => d.UpdatedIngestionRun).WithMany(p => p.CodeBlockUpdatedIngestionRuns).HasConstraintName("fk_code_block_updated_ingestion_run");
        });

        modelBuilder.Entity<DocPage>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_doc_page");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_doc_page_id");
            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.IsActive).HasDefaultValue(true, "df_doc_page_is_active");
            entity.Property(e => e.SemanticUidHash)
                .HasComputedColumnSql("(CONVERT([binary](32),hashbytes('SHA2_256',[semantic_uid])))", true)
                .IsFixedLength();

            entity.HasOne(d => d.CreatedIngestionRun).WithMany(p => p.DocPages)
                .OnDelete(DeleteBehavior.ClientSetNull)
                .HasConstraintName("fk_doc_page_created_ingestion_run");

            entity.HasOne(d => d.SourceSnapshot).WithMany(p => p.DocPages)
                .OnDelete(DeleteBehavior.ClientSetNull)
                .HasConstraintName("fk_doc_page_source_snapshot");
        });

        modelBuilder.Entity<DocPageDiff>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_doc_page_diff");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_doc_page_diff_id");
        });

        modelBuilder.Entity<DocSection>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_doc_section");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_doc_section_id");
            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.IsActive).HasDefaultValue(true, "df_doc_section_is_active");
            entity.Property(e => e.SemanticUidHash)
                .HasComputedColumnSql("(CONVERT([binary](32),hashbytes('SHA2_256',[semantic_uid])))", true)
                .IsFixedLength();

            entity.HasOne(d => d.CreatedIngestionRun).WithMany(p => p.DocSectionCreatedIngestionRuns)
                .OnDelete(DeleteBehavior.ClientSetNull)
                .HasConstraintName("fk_doc_section_created_ingestion_run");

            entity.HasOne(d => d.DocPage).WithMany(p => p.DocSections)
                .OnDelete(DeleteBehavior.ClientSetNull)
                .HasConstraintName("FK_doc_section_doc_page");

            entity.HasOne(d => d.RemovedIngestionRun).WithMany(p => p.DocSectionRemovedIngestionRuns).HasConstraintName("fk_doc_section_removed_ingestion_run");

            entity.HasOne(d => d.UpdatedIngestionRun).WithMany(p => p.DocSectionUpdatedIngestionRuns).HasConstraintName("fk_doc_section_updated_ingestion_run");
        });

        modelBuilder.Entity<ExecutionResult>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_execution_result");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_execution_result_id");
        });

        modelBuilder.Entity<ExecutionRun>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_execution_run");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_execution_run_id");
        });

        modelBuilder.Entity<FeatureDocLink>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_feature_doc_link");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_feature_doc_link_id");
        });

        modelBuilder.Entity<FeatureMemberLink>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_feature_member_link");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_feature_member_link_id");
        });

        modelBuilder.Entity<FeatureTypeLink>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_feature_type_link");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_feature_type_link_id");
        });

        modelBuilder.Entity<IngestionRun>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_ingestion_run");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_ingestion_run_id");
        });

        modelBuilder.Entity<RagChunk>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_rag_chunk");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_rag_chunk_id");
            entity.Property(e => e.EmbeddingVersion).IsFixedLength();
            entity.Property(e => e.TokenCount).IsFixedLength();
        });

        modelBuilder.Entity<RagRun>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_rag_run");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_rag_run_id");
        });

        modelBuilder.Entity<ReviewIssue>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_review_issue");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_review_issue_id");
        });

        modelBuilder.Entity<ReviewItem>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_review_item");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_review_item_id");
        });

        modelBuilder.Entity<ReviewRun>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_review_run");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_review_run_id");
        });

        modelBuilder.Entity<Sample>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_sample");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_sample_id");
        });

        modelBuilder.Entity<SampleApiMemberLink>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_sample_api_member_link");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_sample_api_member_link_id");
        });

        modelBuilder.Entity<SampleRun>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_sample_run");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_sample_run_id");
        });

        modelBuilder.Entity<SemanticIdentity>(entity =>
        {
            entity.HasKey(e => e.Uid).HasName("pk_semantic_identity");

            entity.Property(e => e.UidHash)
                .HasComputedColumnSql("(CONVERT([binary](32),hashbytes('SHA2_256',[uid])))", true)
                .IsFixedLength();
        });

        modelBuilder.Entity<SnapshotDiff>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_snapshot_diff");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_snapshot_diff_id");
        });

        modelBuilder.Entity<SourceSnapshot>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_source_snapshot");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_source_snapshot_id");
            entity.Property(e => e.SnapshotUidHash)
                .HasComputedColumnSql("(CONVERT([binary](32),hashbytes('SHA2_256',[snapshot_uid])))", true)
                .IsFixedLength();
        });

        modelBuilder.Entity<TruthRun>(entity =>
        {
            entity.HasKey(e => e.Id).HasName("pk_truth_run");

            entity.Property(e => e.Id).HasDefaultValueSql("(newid())", "df_truth_run_id");
        });

        modelBuilder.Entity<VApiFeatureCurrent>(entity =>
        {
            entity.ToView("v_api_feature_current");

            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.SemanticUidHash).IsFixedLength();
        });

        modelBuilder.Entity<VApiMemberCurrent>(entity =>
        {
            entity.ToView("v_api_member_current");

            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.MemberUidHash).IsFixedLength();
            entity.Property(e => e.SemanticUidHash).IsFixedLength();
        });

        modelBuilder.Entity<VApiTypeCurrent>(entity =>
        {
            entity.ToView("v_api_type_current");

            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.SemanticUidHash).IsFixedLength();
        });

        modelBuilder.Entity<VDocPageCurrent>(entity =>
        {
            entity.ToView("v_doc_page_current");

            entity.Property(e => e.ContentHash).IsFixedLength();
            entity.Property(e => e.SemanticUidHash).IsFixedLength();
        });

        OnModelCreatingGeneratedFunctions(modelBuilder);
        OnModelCreatingPartial(modelBuilder);
    }

    partial void OnModelCreatingPartial(ModelBuilder modelBuilder);
}